---
title: "Documentation on blockdss"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Documentation on blockdss}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup}
library(blockdss)
```

## Introduction

dss.c.64.exe is a software tool running geostatistical algorithms. Among the algorithms available, dss.c.64.exe runs block sequential simulation using direct sequential simulation algorithm (Soares, 2000^[https://doi.org/10.1023/A:1012246006212]). The blockdss package is a wrapper for running dss.c.64.exe block direct sequential simulation as an R package, as it provides functions for interfacing with dss.c.64.exe.

This tutorial shows how to run block sequential simulation with R for disease mapping, modelling the spatial distribution of covid-19, as in Azevedo et al. 2020^[https://doi.org/10.1186/s12942-020-00221-5]. For that purpose the tutorial shows step-by-step guide using covid-19 data to simulate covid-19 risk maps, median risk map and risk uncertainty map. 

A wrapper function for running a visualization tool developed by Aimee Taylor and colleagues^[https://doi.org/10.48550/arXiv.2005.11993] is also included in blockdss package to merge covid-19 median risks and associated spatial uncertainty in a single-map.

## Software: dss.c.64.exe

In default (working) directory create a folder called `input` and put the dss.c.64.exe^[available at github] inside.

## Datasets

To perform the block simulation algorithm a minimum number of 2 datasets are required: 

- a data frame with spatial data point locations;  
- a grid with id region values at all simulation locations (*grid nodes*).

Datasets for this example are included in the blockdss package. To load the datasets:

```{r}
data(ptdata)
data(ptgrid)
```

Write `?ptdata` and `?ptgrid` in console for details on datasets.

### `ptgrid` dataset

```{r ptgrid transform}
coordinates(ptgrid) = ~x+y
class(ptgrid)

# gridded data (pixels) 
gridded(ptgrid) = TRUE
class(ptgrid)
plot(ptgrid)
```



## Acknowledgements

Manuel Ribeiro acknowledges the financial support of the CERENA (project FCT-UIDB/04028/2020) and Fundação para a Ciencia e Tecnologia (research contract IF2018-CP1384). Manuel Ribeiro gratefully acknowledge CERENA-IST/UL researchers Leonardo Azevedo, Maria João Pereira and Amilcar Soares for the code in Matlab and Fortran.

